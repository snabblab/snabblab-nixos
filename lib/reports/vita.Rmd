---
title: "Simple functional benchmarks"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
---

# Vita benchmark report

This report makes a basic comparison of how several Vita versions perform.

Benchmarks:

* `vita-loopback` is a synthetic benchmark measuring Vita performance on a
  single route with multiple packet sizes.

## Setup

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, error = TRUE, fig.width = 10, fig.height = 10)
```

```{r}
library(ggplot2)
dat <- read.csv("bench.csv")
d <- as.data.frame(dat)
# "sliced" is the dataset with unwanted rows excluded
sliced <- subset(d, subset=(benchmark == "vita-loopback"))
```

## Line graph

[Line graph](https://en.wikipedia.org/wiki/Line_graph) for a simple and direct
look at the results. The Y-scale starts at 0 to put the absolute differences in
perspective.

```{r}
p <- ggplot(sliced, aes(y=score, x=id, color=snabb))
p <- p + theme(legend.position="top")
p <- p + geom_point()
p <- p + geom_line()
p <- p + expand_limits(y=0)
p <- p + facet_grid(pktsize ~ benchmark, scales = "free")
p + ggtitle("Sequential test results")
```

## Box plot

[Box plot](https://en.wikipedia.org/wiki/Box_plot) to summarize the
distribution of results. The Y-axis origin is free to put focus on the relative
differences.

```{r}
p <- ggplot(sliced, aes(x=id, y=score, color=snabb))
p <- p + theme(legend.position="top")
p <- p + geom_boxplot(alpha=0.50)
p <- p + facet_grid(pktsize ~ benchmark, scales = "free")
p + ggtitle("Summary of test results")
```

## Density plot

[Density plot](https://en.wikipedia.org/wiki/Density_estimation) showing the
distribution of results. The curve is high around common values and low around
rare values. Here we can see how spread out they are, how they cluster
together, etc.

```{r}
p <- ggplot(sliced, aes(score, fill = snabb, color = snabb))
p <- p + theme(legend.position="top")
p <- p + geom_density(alpha = 0.1)
p <- p + facet_grid(pktsize ~ benchmark, scales = "free")
p + ggtitle("Shape (distribution) of test results")
```
